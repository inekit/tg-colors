{"version":3,"file":"js/258.faed545e.js","mappings":"yPAOSA,MAAM,iB,GACFA,MAAM,e,GAGEA,MAAM,iB,uBAINA,MAAM,kB,GAEHC,OAAA,I,sJAhBpBC,EAAAA,EAAAA,GAA2D,mBAApDC,EAAAA,YAAc,mBAAqB,WAAxB,IAClBC,EAAAA,EAAAA,IAAeC,IACfD,EAAAA,EAAAA,IAA2FE,EAAAA,CAA1EN,MAAM,YAAYO,IAAI,YAAYC,QAAQ,e,WAC3DJ,EAAAA,EAAAA,IAA2FE,EAAAA,CAA1EN,MAAM,YAAYO,IAAI,YAAYC,QAAQ,e,WAC3DJ,EAAAA,EAAAA,IAA2FE,EAAAA,CAA1EN,MAAM,YAAYO,IAAI,YAAYC,QAAQ,e,WAE3DN,EAAAA,EAAAA,GAeM,MAfNO,EAeM,gBAdFC,EAAAA,EAAAA,IAaMC,EAAAA,GAAAA,MAAAA,EAAAA,EAAAA,IAbyCR,EAAAA,OAAOS,MAAMC,SAAW,IAAJ,CAAnCC,EAAMC,M,WAAtCL,EAAAA,EAAAA,IAaM,MAbNM,EAaM,EAZFZ,EAAAA,EAAAA,IAWca,EAAAA,CAVTC,GAAE,UAAYJ,EAAKK,kBAAkBhB,EAAAA,oBAAoBiB,KAAKC,YAAYC,iBAAiBF,KAAKC,YAAYE,Y,mBAC7G,IAGM,EAHNrB,EAAAA,EAAAA,GAGM,MAHNsB,EAGM,EAFFtB,EAAAA,EAAAA,GAC0F,OADpFuB,IAAG,SAAWC,EAAAA,eAAeZ,EAAKa,aAAa,MAChDC,QAAO,gDAAkDd,EAAKa,aAAa,Q,aAEpFzB,EAAAA,EAAAA,GAIM,MAJN2B,EAIM,EAHF3B,EAAAA,EAAAA,GAAyB,mBAAlBY,EAAKgB,OAAK,IACjB5B,EAAAA,EAAAA,GAA0D,KAA1D6B,EAAW,OAAG,QAAGL,EAAAA,YAAYZ,EAAKkB,gBAAiB,KAAE,Q,8EAiBzE,GACIC,WAAY,CAAEC,YAAW,IAAEC,gBAAeA,EAAAA,IAC1CC,OACI,MAAO,CACHC,KAAM,EACNC,QAAS,GACTjB,YAAa,CAAC,EAGtB,EACAkB,MAAO,CACH,2BAA4BC,uBAClBpB,KAAKqB,WAAW,IAC1B,EACA,uBAAwBD,uBACdpB,KAAKqB,WAAW,IAC1B,EACAD,aAAatB,EAAIwB,GAEjB,GAEJF,oBACI,MAAMG,EAAUvB,KAAKwB,QAAQC,QAAQC,QAAQlC,MAAM+B,SAASI,UAAU,EAAG,GAEzE,GADAC,QAAQC,IAAIN,EAASA,EAAQI,UAAU,EAAG,GAAI3B,KAAKwB,QAAQC,QAAQC,QAAQlC,MAAMsC,OAAOC,KACvE,MAAZR,GAA+B,MAAZA,IAAoBvB,KAAKgC,OAAOxC,MAAMC,SAASwC,OAEhE,CACHjC,KAAKgC,OAAOxC,MAAMC,QAAU,GAC5BO,KAAKkC,UAAYC,SAASC,KAAKC,aAC/BrC,KAAK8B,SACLQ,OAAOC,UAAUC,OAAOC,WAAWC,QAAQ1C,KAAK2C,WAChDL,OAAOC,UAAUC,OAAOC,WAAWG,OAEnC,IAAIC,EAAMP,OAAOQ,SAASC,OAAOpB,UAAU,GAC3C3B,KAAKgD,OAAS,IAAIC,gBAAgBJ,GAClC7C,KAAKC,YAAc,CAAEC,KAAMF,KAAKgD,OAAOE,IAAI,QAAS/C,SAAUH,KAAKgD,OAAOE,IAAI,aAC9ElD,KAAKmD,YAAiD,SAAnCnD,KAAKgD,OAAOE,IAAI,eAA4B,KAAOlD,KAAKgD,OAAOE,IAAI,eAEtFlD,KAAKgC,OAAOxC,MAAM4D,OAASpD,KAAKgC,OAAOxC,MAAM4D,QAAUpD,KAAKqD,OAAOL,QAAQI,aAGjEpD,KAAKsD,mBACXhB,OAAOC,UAAUC,OAAOe,WAAWb,QAAQ1C,KAAKwD,eAChDlB,OAAOC,UAAUC,OAAOe,WAAWX,OACnCN,OAAOC,UAAUC,OAAOe,WAAWE,QAAQ,aAE3CnB,OAAOC,UAAUC,OAAOe,WAAWG,SAAS1D,KAAKwD,eACjDlB,OAAOC,UAAUC,OAAOe,WAAWI,OAE3C,MAxBIxB,SAASC,KAAKwB,UAAY5D,KAAKgC,OAAOxC,MAAMqE,kBAAoB,CAyBxE,EACAzC,gBAEA,EACAA,sBACIkB,OAAOC,UAAUC,OAAOe,WAAWG,SAAS1D,KAAKwD,eACjDlB,OAAOC,UAAUC,OAAOe,WAAWI,OACnCrB,OAAOC,UAAUC,OAAOC,WAAWiB,SAAS1D,KAAK2C,WACjDL,OAAOC,UAAUC,OAAOC,WAAWkB,OACnC3D,KAAKgC,OAAOxC,MAAMqE,iBAAmB1B,SAASC,KAAKwB,SACvD,EACAE,QAAS,CACLN,gBACIxD,KAAKwB,QAAQuC,KAAK,UACtB,EACApB,YACI3C,KAAKwB,QAAQwC,IAAI,EACrB,EACAC,YAAYrD,GACR,OAAOsD,KAAKC,OAAQvD,GAAewD,KAAIC,GAAMA,EAAGC,SAAU,CAAC,GAC/D,EACAlD,wBACI,MAAM3B,QAAgBO,KAAKgC,OAAOxC,MAAM+E,MAAMrB,IAAIlD,KAAKgC,OAAOxC,MAAMgF,SAAW,eAAgB,CAC3FxB,OAAQ,CACJyB,QAASzE,KAAKgC,OAAOxC,MAAM4D,UAG9BsB,MAAKC,GACKA,EAAS3D,KAAK4D,iBAAmBD,EAAS3D,KAAK6D,UAAU5C,SAEnE6C,OAAMC,IAAOC,EAAAA,EAAAA,MAAe,aAAcD,EAAE,IAEjD,OAAOtF,CAEX,EACA2B,iBAAiB6D,GACbrD,QAAQC,IAAI,KACZ7B,KAAKgC,OAAOxC,MAAMC,cAAgBO,KAAKkF,mBAAkB,GAEzDlF,KAAKmF,MAAM,kBAAkBC,UAAUC,IAAI,UAC3ClD,SAASC,KAAKgD,UAAUC,IAAI,kBAG5BC,YAAW,KACP,MAAMC,EAAWpD,SAASqD,uBAAuB,aAEjD5D,QAAQC,IAAI0D,GAEZ,IAAK,IAAIlB,KAAMkB,EACXlB,EAAGe,UAAUC,IAAI,UAErBrF,KAAKmF,MAAM,kBAAkBC,UAAUK,OAAO,UAC9CtD,SAASC,KAAKgD,UAAUK,OAAO,iBAAiB,GAEjDR,EACP,EACAnD,SACIQ,OAAOoD,SAAWtE,UACd,IAAIuE,EAAerD,OAAOsD,QAAUtD,OAAOuD,YAAc,IAAO1D,SAAS2D,gBAAgBC,aAEzF,GAAIJ,IAAiB3F,KAAKgG,gBAAkBhG,KAAKiG,QAAS,CACtDjG,KAAKgG,eAAgB,EACrB,MAAME,QAAelG,KAAKkF,oBAC1BlF,KAAKgC,OAAOxC,MAAMC,QAAU,IAAIO,KAAKgC,OAAOxC,MAAMC,WAAYyG,EAClE,EAER,EACA9E,wBAAwB+E,GAChBA,IACAnG,KAAKiG,SAAU,EACfjG,KAAKiB,KAAO,GAEhB,MAAMmF,EAAU,SAEV3G,QAAgBO,KAAKgC,OAAOxC,MAAM+E,MAAMrB,IAAIlD,KAAKgC,OAAOxC,MAAMgF,SAAW4B,EAAS,CACpFpD,OAAQ,CACJqD,YAAarG,KAAKgC,OAAOxC,MAAM6G,YAC/BC,KAAM,GACNrF,KAAMjB,KAAKiB,MAAQ,EACnBsF,KAAMvG,KAAKgC,OAAOxC,MAAMgH,QAAQC,UAChCC,SAAU1G,KAAKgC,OAAOxC,MAAMgH,QAAQG,cACpClC,QAASzE,KAAKgC,OAAOxC,MAAM4D,OAC3BlD,KAAMF,KAAKC,aAAaC,KACxB0G,cAAa5G,KAAKC,aAAaC,KAC/BC,SAAUH,KAAKC,aAAaE,YAG/BuE,MAAKC,IACF,MAAMkC,EAAUlC,EAAS3D,KAQzB,OANI6F,EAAQ5E,OAAUjC,KAAKkB,QAAUlB,KAAKiG,SAAU,EAC/CjG,KAAKiB,OAEVjB,KAAKgG,eAAgB,EAGda,CAAO,IAEjB/B,OAAMC,IAAOC,EAAAA,EAAAA,MAAe,aAAcD,EAAE,IAIjD,OAFAnD,QAAQC,IAAIpC,GAELA,CAEX,EACAqH,eAAeC,GACX,MAAMC,EAAQD,EAAKE,MAAM,gBACzB,GAAKD,IAAQ,GACb,OAAOD,GAAMG,MAAM,KAAKC,MAAM,GAAI,GAAGC,KAAK,KAAO,YAAcJ,EAAM,EAEzE,I,QC3LR,MAAMK,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://@coreui/coreui-free-vue-admin-template/./src/views/Results.vue","webpack://@coreui/coreui-free-vue-admin-template/./src/views/Results.vue?c515"],"sourcesContent":["<template>\r\n    <h1>{{ mainside_id ? \"Обратная сторона\" : \"Каталог\" }}</h1>\r\n    <searchBlock />\r\n    <InstagramLoader class=\"preloader\" ref=\"preloader\" viewBox=\"0 0 300 250\"></InstagramLoader>\r\n    <InstagramLoader class=\"preloader\" ref=\"preloader\" viewBox=\"0 0 300 200\"></InstagramLoader>\r\n    <InstagramLoader class=\"preloader\" ref=\"preloader\" viewBox=\"0 0 300 200\"></InstagramLoader>\r\n\r\n    <div class=\"results-block\">\r\n        <div class=\"result-item\" v-for=\"item, index in $store.state.results ?? []\">\r\n            <router-link\r\n                :to=\"`/items/${item.id}?mainside_id=${mainside_id}&size=${this.backFilters.size}&material=${this.backFilters.material}`\">\r\n                <div class=\"img-container\">\r\n                    <img :src=\"`/pics/${getPreviewLink(item.image_list?.[0])}`\"\r\n                        :onerror=\"`javascript:this.onerror=null;this.src='/pics/${item.image_list?.[0]}';`\" />\r\n                </div>\r\n                <div class=\"text-container\">\r\n                    <h2>{{ item.title }}</h2>\r\n                    <h3 hidden>От {{ getMinPrice(item.options_array) }} ₽</h3>\r\n\r\n                </div>\r\n            </router-link>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport searchBlock from '@/components/Search.vue';\r\nimport eventBus from '../eventBus'\r\nimport { ListLoader, InstagramLoader } from 'vue-content-loader'\r\n/*<button @click=\"routeToBasket\">Корзина</button>\r\n<div class=\"favorite-toggle\" :class=\"item.is_favorite ? 'favorite-item' : ''\">\r\n                    <img :src=\"require('@/assets/img/fav.svg')\" />\r\n                </div> */\r\n\r\nexport default {\r\n    components: { searchBlock, InstagramLoader },\r\n    data() {\r\n        return {\r\n            page: 1,\r\n            perPage: 10,\r\n            backFilters: {}\r\n        }\r\n\r\n    },\r\n    watch: {\r\n        \"$store.state.searchQuery\": async function () {\r\n            await this.updatePage(300)\r\n        },\r\n        \"$store.state.filters\": async function () {\r\n            await this.updatePage(300)\r\n        },\r\n        async $route(to, from) {\r\n            //await this.toggleButtons()\r\n        }\r\n    },\r\n    async beforeMount() {\r\n        const forward = this.$router.options.history.state.forward?.substring(1, 2)\r\n        console.log(forward, forward.substring(1, 2), this.$router.options.history.state.scroll.top)\r\n        if ((forward === 'i' || forward === 'b') && this.$store.state.results?.length) {\r\n            document.body.scrollTop = this.$store.state.scrollTopResults ?? 0\r\n        } else {\r\n            this.$store.state.results = []\r\n            this.bodyWidth = document.body.clientHeight\r\n            this.scroll()\r\n            window.Telegram?.WebApp.BackButton.onClick(this.routeBack);\r\n            window.Telegram?.WebApp.BackButton.show();\r\n\r\n            let uri = window.location.search.substring(1);\r\n            this.params = new URLSearchParams(uri)\r\n            this.backFilters = { size: this.params.get('size'), material: this.params.get('material') }\r\n            this.mainside_id = this.params.get('mainside_id') === \"null\" ? null : this.params.get('mainside_id')\r\n\r\n            this.$store.state.userId = this.$store.state.userId ?? this.$route.params?.userId;\r\n\r\n\r\n            if (await this.haveBasketItems()) {\r\n                window.Telegram?.WebApp.MainButton.onClick(this.routeToBasket);\r\n                window.Telegram?.WebApp.MainButton.show();\r\n                window.Telegram?.WebApp.MainButton.setText(\"Корзина\");\r\n            } else {\r\n                window.Telegram?.WebApp.MainButton.offClick(this.routeToBasket);\r\n                window.Telegram?.WebApp.MainButton.hide();\r\n            }\r\n        }\r\n    },\r\n    async mounted() {\r\n\r\n    },\r\n    async beforeUnmount() {\r\n        window.Telegram?.WebApp.MainButton.offClick(this.routeToBasket);\r\n        window.Telegram?.WebApp.MainButton.hide();\r\n        window.Telegram?.WebApp.BackButton.offClick(this.routeBack);\r\n        window.Telegram?.WebApp.BackButton.hide();\r\n        this.$store.state.scrollTopResults = document.body.scrollTop\r\n    },\r\n    methods: {\r\n        routeToBasket() {\r\n            this.$router.push(\"/basket\")\r\n        },\r\n        routeBack() {\r\n            this.$router.go(-1)\r\n        },\r\n        getMinPrice(options_array) {\r\n            return Math.min(...(options_array?.map(el => el.price) ?? [0]))\r\n        },\r\n        async haveBasketItems() {\r\n            const results = await this.$store.state.myApi.get(this.$store.state.restAddr + '/basket_data', {\r\n                params: {\r\n                    user_id: this.$store.state.userId,\r\n                }\r\n            })\r\n                .then(response => {\r\n                    return response.data.individual_text || response.data.favorites.length\r\n                })\r\n                .catch(e => { eventBus.$emit('noresponse', e) })\r\n\r\n            return results\r\n\r\n        },\r\n        async updatePage(delay) {\r\n            console.log(123)\r\n            this.$store.state.results = await this.sendSearchRequest(true);\r\n\r\n            this.$refs['results-block']?.classList.add(\"hidden\")\r\n            document.body.classList.add('stop-scrolling')\r\n\r\n\r\n            setTimeout(() => {\r\n                const elements = document.getElementsByClassName('preloader')\r\n\r\n                console.log(elements)\r\n\r\n                for (let el of elements) {\r\n                    el.classList.add(\"hidden\")\r\n                }\r\n                this.$refs['results-block']?.classList.remove(\"hidden\")\r\n                document.body.classList.remove('stop-scrolling')\r\n\r\n            }, delay)\r\n        },\r\n        scroll() {\r\n            window.onscroll = async () => {\r\n                let bottomwindow = window.scrollY + window.innerHeight + 2000 > document.documentElement.scrollHeight;\r\n\r\n                if (bottomwindow && !this.loadingUpdate && !this.isEnded) {\r\n                    this.loadingUpdate = true;\r\n                    const update = await this.sendSearchRequest();\r\n                    this.$store.state.results = [...this.$store.state.results, ...update];\r\n                }\r\n            };\r\n        },\r\n        async sendSearchRequest(isReload) {\r\n            if (isReload) {\r\n                this.isEnded = false\r\n                this.page = 1\r\n            }\r\n            const subPath = '/items'\r\n\r\n            const results = await this.$store.state.myApi.get(this.$store.state.restAddr + subPath, {\r\n                params: {\r\n                    searchQuery: this.$store.state.searchQuery,\r\n                    take: 30,\r\n                    page: this.page ?? 1,\r\n                    sort: this.$store.state.filters.sort_type,\r\n                    category: this.$store.state.filters.category_name,\r\n                    user_id: this.$store.state.userId,\r\n                    size: this.backFilters?.size,\r\n                    is_backside: this.backFilters?.size ? true : false,\r\n                    material: this.backFilters?.material\r\n                }\r\n            })\r\n                .then(response => {\r\n                    const newsUpd = response.data;\r\n\r\n                    if (newsUpd.length < (this.perPage)) this.isEnded = true;\r\n                    else this.page++;\r\n\r\n                    this.loadingUpdate = false;\r\n\r\n\r\n                    return newsUpd;\r\n                })\r\n                .catch(e => { eventBus.$emit('noresponse', e) })\r\n\r\n            console.log(results)\r\n\r\n            return results\r\n\r\n        },\r\n        getPreviewLink(link) {\r\n            const parts = link.match(/\\.([^.]+)$|$/)\r\n            if (!parts?.[1]) return;\r\n            return link?.split('.').slice(0, -1).join('.') + '_preview.' + parts[1]\r\n\r\n        }\r\n    }\r\n}\r\n</script>\r\n  \r\n\r\n<style lang=\"scss\">\r\n.results-block {\r\n    display: flex;\r\n    gap: 12px;\r\n    width: calc(100% - 2rem);\r\n    margin: 1rem;\r\n    padding: 0;\r\n    list-style: none;\r\n    flex-wrap: wrap;\r\n\r\n    .masonry-column {\r\n        flex: 1 1 calc((100% / 3) - 2rem) !important;\r\n    }\r\n\r\n\r\n    .result-item {\r\n        width: 100%;\r\n        height: fit-content; //calc(70vw - 1.5rem);\r\n        //margin: 1rem;\r\n        //margin-bottom: 0;\r\n        margin: 0;\r\n        // flex: 1 1 calc((100% / 3) - 2rem) !important;\r\n        flex: 0 0 calc(33% - 7.2px) !important;\r\n\r\n        border-radius: 1rem;\r\n        display: block;\r\n        background-color: transparent;\r\n        // border: 1px solid rgb(169, 169, 169);\r\n        box-shadow: 0px 1px 5px rgb(216, 216, 216);\r\n        overflow: hidden;\r\n        position: relative;\r\n\r\n        &:nth-child(4n) {\r\n            // margin-top: -6vw\r\n        }\r\n\r\n        &:nth-child(4n+1),\r\n        &:nth-child(4n) {\r\n            .img-container {\r\n                //height: 40vw;\r\n            }\r\n        }\r\n\r\n        .img-container {\r\n            //position: absolute;\r\n            background-color: #414141;\r\n            width: 100%;\r\n            height: calc(32vw - 1rem);\r\n\r\n            position: relative;\r\n            overflow: hidden;\r\n        }\r\n\r\n\r\n\r\n        a {\r\n            display: block;\r\n            text-decoration: none;\r\n            //position: absolute;\r\n            height: calc(140% + 2rem);\r\n            width: calc(100%);\r\n\r\n            //margin: 1rem;\r\n            .text-container {\r\n                padding: 0.7rem;\r\n                //position: absolute;\r\n                top: 70%;\r\n                width: calc(100% - 1.4rem);\r\n\r\n            }\r\n\r\n            h2 {\r\n                margin: 0;\r\n                width: 100%;\r\n                color: #414141;\r\n                color: var(--tg-theme-text-color);\r\n                font-weight: 400;\r\n                font-size: 3.8vw;\r\n                //word-wrap: break-word;\r\n                text-align: center;\r\n            }\r\n\r\n            h3 {\r\n                margin: 5px 0 -5px 0;\r\n                color: #414141;\r\n                color: var(--tg-theme-text-color);\r\n                font-weight: 200;\r\n                font-size: 1rem;\r\n            }\r\n\r\n            img {\r\n                position: absolute;\r\n                margin: auto;\r\n                top: 50%;\r\n                left: 50%;\r\n                transform: translate(-50%, -50%);\r\n                max-width: 300%;\r\n                max-height: 130%;\r\n                min-width: 100%;\r\n                min-height: 100%;\r\n                width: auto;\r\n                height: auto;\r\n            }\r\n        }\r\n\r\n        &:nth-child(2n-1) {\r\n            //margin-right: 0.5rem;\r\n        }\r\n\r\n        &:nth-child(2n) {\r\n            //margin-left: 0.5rem;\r\n        }\r\n\r\n        .favorite-toggle {\r\n            content: '';\r\n            width: 40px;\r\n            height: 40px;\r\n            border-radius: 13px;\r\n            background-color: transparent;\r\n            border: 1px solid;\r\n            background-color: #6e6e6e;\r\n            border-color: #6e6e6e;\r\n            opacity: 0;\r\n            position: absolute;\r\n            top: 0.5rem;\r\n            right: 0.5rem;\r\n            transition: all 0.2s;\r\n\r\n            img {\r\n                height: 50%;\r\n                margin: 25%;\r\n            }\r\n\r\n            &.favorite-item {\r\n                opacity: 1;\r\n                z-index: 1;\r\n                border-color: rgb(197, 80, 105);\r\n                background-color: rgb(197, 80, 105);\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n</style>\r\n  ","import { render } from \"./Results.vue?vue&type=template&id=2cfc071a\"\nimport script from \"./Results.vue?vue&type=script&lang=js\"\nexport * from \"./Results.vue?vue&type=script&lang=js\"\n\nimport \"./Results.vue?vue&type=style&index=0&id=2cfc071a&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\Ник\\\\Documents\\\\GitHub\\\\tg-colors-server\\\\webapp\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","hidden","_createElementVNode","_ctx","_createVNode","_component_searchBlock","_component_InstagramLoader","ref","viewBox","_hoisted_1","_createElementBlock","_Fragment","state","results","item","index","_hoisted_2","_component_router_link","to","id","this","backFilters","size","material","_hoisted_3","src","$options","image_list","onerror","_hoisted_5","title","_hoisted_6","options_array","components","searchBlock","InstagramLoader","data","page","perPage","watch","async","updatePage","from","forward","$router","options","history","substring","console","log","scroll","top","$store","length","bodyWidth","document","body","clientHeight","window","Telegram","WebApp","BackButton","onClick","routeBack","show","uri","location","search","params","URLSearchParams","get","mainside_id","userId","$route","haveBasketItems","MainButton","routeToBasket","setText","offClick","hide","scrollTop","scrollTopResults","methods","push","go","getMinPrice","Math","min","map","el","price","myApi","restAddr","user_id","then","response","individual_text","favorites","catch","e","eventBus","delay","sendSearchRequest","$refs","classList","add","setTimeout","elements","getElementsByClassName","remove","onscroll","bottomwindow","scrollY","innerHeight","documentElement","scrollHeight","loadingUpdate","isEnded","update","isReload","subPath","searchQuery","take","sort","filters","sort_type","category","category_name","is_backside","newsUpd","getPreviewLink","link","parts","match","split","slice","join","__exports__","render"],"sourceRoot":""}